<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS365 Data Manager</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 400px; margin: auto; text-align: center; }
        input, button { display: block; width: 100%; margin: 10px 0; padding: 10px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Đăng nhập POS365</h2>
        <input type="text" id="shopName" placeholder="Tên cửa hàng">
        <input type="text" id="username" placeholder="Tên đăng nhập">
        <input type="password" id="password" placeholder="Mật khẩu">
        <button onclick="login()">Đăng nhập</button>
        <div id="actions" class="hidden">
            <h3>Chức năng</h3>
            <button onclick="deleteAllOrders()">Xóa tất cả đơn hàng</button>
            <button onclick="deleteAllProducts()">Xóa tất cả sản phẩm</button>
        </div>
        <p id="status"></p>
    </div>
    <script>
        let shopUrl = "";
        let sessionId = "";
        
        function login() {
            const shopName = document.getElementById("shopName").value.trim();
            const username = document.getElementById("username").value.trim();
            const password = document.getElementById("password").value.trim();
            shopUrl = `https://${shopName}.pos365.vn`;
            
            fetch(`${shopUrl}/api/auth/credentials?format=json&Username=${username}&Password=${password}`)
                .then(response => response.json())
                .then(data => {
                    if (data.SessionId) {
                        sessionId = data.SessionId;
                        document.getElementById("actions").classList.remove("hidden");
                        document.getElementById("status").innerText = "Đăng nhập thành công!";
                    } else {
                        document.getElementById("status").innerText = "Đăng nhập thất bại!";
                    }
                });
        }
        
        function deleteAllOrders() {
            fetch(`${shopUrl}/api/orders`, {
                method: 'DELETE',
                headers: { 'Cookie': `ss-id=${sessionId}` }
            }).then(() => {
                document.getElementById("status").innerText = "Đã xóa tất cả đơn hàng.";
            });
        }
        
        function deleteAllProducts() {
            fetch(`${shopUrl}/api/products`, {
                method: 'DELETE',
                headers: { 'Cookie': `ss-id=${sessionId}` }
            }).then(() => {
                document.getElementById("status").innerText = "Đã xóa tất cả sản phẩm.";
            });
        }
    </script>
</body>
</html>
